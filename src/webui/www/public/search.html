<div id="searchResults">
    <div style="overflow: hidden; height: 70px;">
        <div style="margin: 20px 0; width: 1050px; height: 30px;">
            <input type="text" id="searchPattern" style="width: 600px; height: 20px; padding: 1px 5px;" />
            <select style="width: 150px;" id="categorySelect">
                <option value="all">All categories</option>
                <option disabled>-----------------------</option>
                <option>Option 2</option>
            </select>
            <select style="width: 150px;" id="pluginsSelect">
                <option value="all">Only enabled</option>
                <option value="all">All plugins</option>
                <option>Select...</option>
                <option disabled>-----------------------</option>
                <option>Option 4</option>
            </select>
            <button style="width: 90px; height: 20px;" id="startSearchButton" onclick="startStopSearch();">Search</button>
        </div>
    </div>

    <div style="height: 30px;">
        <span>Results (<span id="numSearchResults">0</span>)</span>
    </div>

    <div style="height: calc(100% - 140px); overflow: auto;">
        <div id="searchResultsTableFixedHeaderDiv" class="dynamicTableFixedHeaderDiv">
            <table class="dynamicTable" style="position:relative;">
                <thead>
                    <tr class="dynamicTableHeader"></tr>
                </thead>
            </table>
        </div>
        <div id="searchResultsTableDiv" class="dynamicTableDiv">
            <table class="dynamicTable">
                <thead>
                    <tr class="dynamicTableHeader"></tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <div style="height: 30px; padding-top: 10px;">
        <input type="button" style="width: 150;" value="Download Torrent" />
        <input type="button" style="width: 160;" value="Torrent Description" />
        <input type="button" style="width: 100;" value="Copy URL" />
        <input type="button" style="width: 140; float: right;" value="Manage Plugins" />
    </div>
</div>

<script type="text/javascript">
    searchResultsTable.setup('searchResultsTableDiv', 'searchResultsTableFixedHeaderDiv', null);

    startStopSearch = function() {
        if (!searchRunning) {
            var pattern = $('searchPattern').getProperty('value').trim();
            var category = $('categorySelect').getProperty('value');
            var plugins = $('pluginsSelect').getProperty('value');

            if (!pattern || !category || !plugins) return;

            clearTimeout(loadSearchResultsTimer);
            searchResultsTable.clear();
            $('numSearchResults').set('html', searchResultsTable.getRowIds().length);
            searchResultsRowId = 0;

            var url = new URI('command/startSearch');
            var request = new Request({
                url: url,
                noCache: true,
                method: 'post',
                data: {
                    pattern: pattern,
                    category: category,
                    plugins: plugins
                },
                onFailure: function() {
                    $('error_div').set('html', 'QBT_TR(qBittorrent client is not reachable)QBT_TR[CONTEXT=HttpServer]');
                },
                onSuccess: function(response) {
                    if (response === "Ok.") {
                        $('error_div').set('html', '');
                        $('startSearchButton').set('text', 'Stop');
                        searchRunning = true;
                        updateSearchResultsData();
                    }
                    else {
                        $('error_div').set('html', 'QBT_TR(qBittorrent client is not reachable)QBT_TR[CONTEXT=HttpServer]');
                    }
                }
            }).send();
        }
        else {
            var url = new URI('command/cancelSearch');
            var request = new Request({
                url: url,
                noCache: true,
                method: 'post',
                onFailure: function() {
                    $('error_div').set('html', 'QBT_TR(qBittorrent client is not reachable)QBT_TR[CONTEXT=HttpServer]');
                },
                onSuccess: function(response) {
                    $('error_div').set('html', '');
                    $('startSearchButton').set('text', 'Search');
                    searchRunning = false;
                    clearTimeout(loadSearchResultsTimer);
                }
            }).send();
        }
    };
    };
</script>
